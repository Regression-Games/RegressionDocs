---
sidebar_label: 'Recording Gameplay'
---

# Recording Gameplay

The [RGOverlayCanvas](../getting-started/installing-regression-games#add-the-regression-games-overlay-to-your-scene)
allows you to record game state and user inputs as you play through your game.
This information can be used to [automatically replay the scenario](#replaying-recordings),
validate game behaviour with [Validation Suites](./validation-suites),
and form the basis of complex [Bot Sequences](./bot-sequences/getting-started-with-bot-sequences-and-segments).

At a high level, the SDK captures the following information during gameplay:
* Entities and their state (e.g. position, behaviours, colliders)
* Performance information (e.g. frame rate, memory usage)
* User input (e.g. keyboard, mouse, gamepad)
* Screenshots

The SDK captures this information once every **tick**.
A tick is a snapshot of the game state at a given point in time.
One or more frames may elapse between two ticks, depending on the configured [tick interval](#tick-interval).
Ticks are important to understand when working with the SDK, as they are used to visualize changes in the game state over time.

## Creating a Recording

:::info
Recording requires the [RGOverlayCanvas](../getting-started/installing-regression-games#add-the-regression-games-overlay-to-your-scene)
to be present in your scene.
:::

You can start a recording at any time while playing your game by pressing the **Record** icon in the RG Toolbar.
The icon will pulse to signal that a recording is in progress, and our SDK will begin capturing game state and user inputs.

![Start Recording](img/recording-gameplay/start-recording.png)

Click the **Record** icon again to stop the recording and save captured data to your local device.
If you have provided a valid [API Key in the RG Settings](../getting-started/installing-regression-games#configure-your-api-key),
then a copy of the captured data will also be uploaded to your Regression Games account as a [Gameplay Session](gameplay-sessions).
Gameplay Sessions unlock access to more features through the Regression Games web interface such as [Validation Suites](validation-suites).

## Recorded Data Formats

By default, the SDK saves recordings to your user's home directory under `unity_videos`.
[This directory is configurable](#recording-directory).
The SDK gives each Unity project its own directory matching the project's `Application.productName`.
A recording is saved under its project directory as a folder named `recording_{MM-dd-yyyy_HH.mm}_{sessionId}`.

For example, a recording for a project named "MyGame" may be located at:
```bash
# macOS & Linux
~/unity_videos/MyGame/recording_08-30-2024_14.34_0b8551

# Windows
C:\Users\{MyUser}\unity_videos\MyGame\recording_08-30-2024_14.34_0b8551
```

A recording folder contains multiple files that provide important context about the game's state.
All of this same data is saved to the [Gameplay Session](gameplay-sessions) when data is uploaded
to your Regression Games account at the end of a recording.


### `bot_segments.zip`

This .zip contains numbered JSON files, each representing a delta of the game state at a specific tick.
These files are used to [replay the recording](#replaying-recordings).
[Bot Segments](bot-sequences/getting-started-with-bot-sequences-and-segments) are explained in more detail in their own section,
but they essentially represent actions for the replay tool to produce (such as sending mouse and keyboard inputs),
and outline conditions that should result from those actions.
Bot Segments and Sequences are powerful tools for automating testing, and
the contents of the Segments produced during recording can help you form the basis for your own custom Segments later on.


### `data.zip`

This .zip contains numbered JSON files, each representing the full, unaltered game state at a specific tick.
This data is used by the Regression Games web interface and backend to create and run [Validation Suites](validation-suites).

Each file contains the following information:

* Timing information (e.g. tick number, time, timescale)
* Performance metrics (e.g. frame rate, memory usage)
* Screen size
* Object states (i.e. the game objects / entities within the game at that tick)
* Inputs produced leading up to the tick (e.g. mouse, keyboard)
* Key Frame flags to identify what changed since the previous tick

Some performance metrics are recorded for each frame leading up to the tick,
while others, like render time object stats, are calculated at the time the tick is recorded.

:::caution
Some performance information in the `engineStats` object is collected using UnityStats.
UnityStats is an editor-only feature, so these stats are unavailable when running outside the Unity Editor.
:::

Key Frame flags indicate that important changes occurred to the game state between ticks.
They are represented as an array of strings in the `keyFrame` field of the JSON file.

| Key Frame Type              | Description                                                                                                                                                                   |
|-----------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| FIRST_FRAME                 | Indicates that this tick is the first tick of the recording                                                                                                                   |
| SCENE                       | Indicates that the visible scenes are different from those in the previous tick                                                                                               |
| GAME_ELEMENT                | Indicates that a game element became visible to the camera or moved off-camera. This could be from spawning, de-spawning, character movement, camera rotation, etc.           |
| GAME_ELEMENT_RENDERER_COUNT | Indicates that the number of renderers changed for a visible game element                                                                                                     |
| UI_ELEMENT                  | Indicates that a UI element became visible to the camera or moved off-camera. This could be from spawning, de-spawning, UI component or canvas group visibility changes, etc. |
| UI_PIXELHASH                | Indicates that the screen pixels of a UI component changed. This value is only relevant when using 3rd party UI system like Coherent GameFace.                                |

### `logs.zip`

This .zip contains numbered JSONL files, each containing any runtime logs at a specific tick.
Logs produced between ticks will be recorded in the next tick's log file.
The file may be empty if no logs were produced since the previous tick.

### `screenshots.zip`

This .zip contains numbered JPG files, each representing a screenshot taken at a specific tick.
These are used in the Regression Games web interface to visualize the in-game graphics alongside the game state at a moment in time.

### `thumbnail.jpg`

A single screenshot taken from the middle of the recording.
This is used to help give Gameplay Sessions that are uploaded to RG a visual representation in the web interface.

## Replaying Recordings

Replaying a recording reproduces inputs from the original recording
and captures new game state information during the replay.
This is saved as a new recording and Gameplay Session.
Replay, and recording the replay, can be useful for identifying areas of your game that behave inconsistently
given the same inputs, reproducing bugs and collecting information for debugging them,
or ensuring that changes to your game don't affect unintended behaviours.

:::tip
Replaying a recording file works best in deterministic or mostly-deterministic scenarios.
For example, navigating menus tends to be deterministic, while the locations and movements of NPCs may not be.
The replay tool attempts to account for some inconsistencies, but it is not perfect.
For games with a high degree of randomness or non-determinism, we recommend using recordings as a basis to
create your own customized [Bot Sequences](bot-sequences/getting-started-with-bot-sequences-and-segments)
rather than relying on raw recordings.
:::

There are two ways to initiate a replay: manually selecting a recording via the overlay, or programmatically through our SDK.

### Manual Replay

import ReplayOptions from "./img/recording-gameplay/replay-options.png"
import SuccessfulReplay from "./img/recording-gameplay/successful-replay.png"
import LoopCounter from "./img/recording-gameplay/loop-counter.png"

Press the **Menu** icon in the RG Toolbar in "Play" mode to select a recording to replay.
This will launch a file explorer at the location of your [recordings directory](#recording-directory) on your device.
Navigate into the folder of the recording you'd like to replay, select its `bot_segments.zip` file, and then click **Load Replay**.

![Select a Recording](img/recording-gameplay/select-recording.png)

<div style={{display: "grid", gridAutoFlow: "column", textAlign: "center"}}>

<figure>
    <img src={ReplayOptions} alt="Replay Options"/>
    <figcaption>
        You can <b>Play</b> the recording once or <b>Loop</b> it to play continuously.
        The <b>Stop</b> button stops and unloads the current recording
    </figcaption>
</figure>

<figure>
    <img src={SuccessfulReplay} alt="Successful Replay"/>
    <figcaption>Successful playback results in a green indicator surrounding the <b>Play</b> button</figcaption>
</figure>

<figure>
    <img src={LoopCounter} alt="Loop Counter"/>
    <figcaption>Looping the recording displays a counter for the current loop iteration</figcaption>
</figure>

</div>



### Programmatic Replay

## Advanced Configuration

### Recording Directory

### Tick Interval

### Excluding GameObjects from Data Capture
